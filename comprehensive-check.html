<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¨é¢åŠŸèƒ½æª¢æŸ¥å·¥å…·</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .check-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        .check-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
            font-weight: 600;
        }
        .check-btn:hover {
            background: #0056b3;
        }
        .check-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }
        .check-btn.success {
            background: #28a745;
        }
        .check-btn.error {
            background: #dc3545;
        }
        .result {
            margin-top: 15px;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        .warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #007bff, #0056b3);
            width: 0%;
            transition: width 0.3s ease;
        }
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .status-item {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
        }
        .status-item.success {
            border-color: #28a745;
            background: #d4edda;
        }
        .status-item.error {
            border-color: #dc3545;
            background: #f8d7da;
        }
        .status-item.warning {
            border-color: #ffc107;
            background: #fff3cd;
        }
        .test-input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <h1>ğŸ” å…¨é¢åŠŸèƒ½æª¢æŸ¥å·¥å…·</h1>
    
    <div class="check-container">
        <h2>ğŸ“‹ æª¢æŸ¥é …ç›®ç¸½è¦½</h2>
        <div class="status-grid" id="statusGrid">
            <div class="status-item" id="configStatus">
                <h3>âš™ï¸ é…ç½®æª¢æŸ¥</h3>
                <p>æª¢æŸ¥ Supabase é…ç½®</p>
            </div>
            <div class="status-item" id="connectionStatus">
                <h3>ğŸ”— é€£æ¥æª¢æŸ¥</h3>
                <p>æª¢æŸ¥è³‡æ–™åº«é€£æ¥</p>
            </div>
            <div class="status-item" id="authStatus">
                <h3>ğŸ” èªè­‰æª¢æŸ¥</h3>
                <p>æª¢æŸ¥å­¸ç”Ÿç™»å…¥åŠŸèƒ½</p>
            </div>
            <div class="status-item" id="scoreStatus">
                <h3>ğŸ“Š æˆç¸¾å„²å­˜æª¢æŸ¥</h3>
                <p>æª¢æŸ¥æˆç¸¾å„²å­˜åŠŸèƒ½</p>
            </div>
            <div class="status-item" id="retrieveStatus">
                <h3>ğŸ“¥ æˆç¸¾æŸ¥è©¢æª¢æŸ¥</h3>
                <p>æª¢æŸ¥æˆç¸¾æŸ¥è©¢åŠŸèƒ½</p>
            </div>
            <div class="status-item" id="vocabularyStatus">
                <h3>ğŸ“š é›œèªŒç·´ç¿’æª¢æŸ¥</h3>
                <p>æª¢æŸ¥é›œèªŒç·´ç¿’åŠŸèƒ½</p>
            </div>
            <div class="status-item" id="adminStatus">
                <h3>ğŸ‘¨â€ğŸ’¼ ç®¡ç†å“¡æª¢æŸ¥</h3>
                <p>æª¢æŸ¥ç®¡ç†å“¡åŠŸèƒ½</p>
            </div>
            <div class="status-item" id="percentageStatus">
                <h3>ğŸ“ˆ ç™¾åˆ†æ¯”è¨ˆç®—æª¢æŸ¥</h3>
                <p>æª¢æŸ¥ç™¾åˆ†æ¯”è¨ˆç®—</p>
            </div>
        </div>
    </div>

    <div class="check-container">
        <h2>ğŸ”§ æ¸¬è©¦åŠŸèƒ½</h2>
        <button class="check-btn" onclick="runAllChecks()">åŸ·è¡Œå…¨é¢æª¢æŸ¥</button>
        <button class="check-btn" onclick="testStudentLogin()">æ¸¬è©¦å­¸ç”Ÿç™»å…¥</button>
        <button class="check-btn" onclick="testScoreSave()">æ¸¬è©¦æˆç¸¾å„²å­˜</button>
        <button class="check-btn" onclick="testVocabularyQuiz()">æ¸¬è©¦é›œèªŒç·´ç¿’</button>
        <button class="check-btn" onclick="testAdminPanel()">æ¸¬è©¦ç®¡ç†å“¡é¢æ¿</button>
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        <div id="checkResult" class="result" style="display: none;"></div>
    </div>

    <div class="check-container">
        <h2>ğŸ“ æ¸¬è©¦è³‡æ–™</h2>
        <input type="text" id="testStudentName" class="test-input" placeholder="æ¸¬è©¦å­¸ç”Ÿå§“å" value="Annie">
        <input type="text" id="testStudentPassword" class="test-input" placeholder="æ¸¬è©¦å­¸ç”Ÿå¯†ç¢¼" value="1234">
        <button class="check-btn" onclick="addTestStudent()">æ·»åŠ æ¸¬è©¦å­¸ç”Ÿ</button>
        <button class="check-btn" onclick="viewAllStudents()">æŸ¥çœ‹æ‰€æœ‰å­¸ç”Ÿ</button>
        <div id="testDataResult" class="result" style="display: none;"></div>
    </div>

    <div class="check-container">
        <h2>ğŸ“Š è³‡æ–™åº«ç‹€æ…‹</h2>
        <div id="databaseStatus"></div>
    </div>

    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="supabase-config.js"></script>
    <script src="api-supabase-client.js"></script>
    <script>
        let checkResults = {};

        // æ›´æ–°ç‹€æ…‹é¡¯ç¤º
        function updateStatus(id, status, message) {
            const statusItem = document.getElementById(id);
            statusItem.className = `status-item ${status}`;
            statusItem.querySelector('p').textContent = message;
            checkResults[id] = { status, message };
        }

        // åŸ·è¡Œå…¨é¢æª¢æŸ¥
        async function runAllChecks() {
            const resultDiv = document.getElementById('checkResult');
            const progressFill = document.getElementById('progressFill');
            
            resultDiv.style.display = 'block';
            resultDiv.className = 'result info';
            resultDiv.innerHTML = 'ğŸ”„ é–‹å§‹åŸ·è¡Œå…¨é¢æª¢æŸ¥...';

            const checks = [
                { id: 'configStatus', name: 'é…ç½®æª¢æŸ¥', func: checkConfig },
                { id: 'connectionStatus', name: 'é€£æ¥æª¢æŸ¥', func: checkConnection },
                { id: 'authStatus', name: 'èªè­‰æª¢æŸ¥', func: checkAuth },
                { id: 'scoreStatus', name: 'æˆç¸¾å„²å­˜æª¢æŸ¥', func: checkScoreSave },
                { id: 'retrieveStatus', name: 'æˆç¸¾æŸ¥è©¢æª¢æŸ¥', func: checkScoreRetrieve },
                { id: 'vocabularyStatus', name: 'é›œèªŒç·´ç¿’æª¢æŸ¥', func: checkVocabulary },
                { id: 'adminStatus', name: 'ç®¡ç†å“¡æª¢æŸ¥', func: checkAdmin },
                { id: 'percentageStatus', name: 'ç™¾åˆ†æ¯”è¨ˆç®—æª¢æŸ¥', func: checkPercentage }
            ];

            let successCount = 0;
            let totalCount = checks.length;

            for (let i = 0; i < checks.length; i++) {
                const check = checks[i];
                try {
                    await check.func();
                    successCount++;
                    updateStatus(check.id, 'success', `âœ… ${check.name}é€šé`);
                } catch (error) {
                    updateStatus(check.id, 'error', `âŒ ${check.name}å¤±æ•—: ${error.message}`);
                }

                // æ›´æ–°é€²åº¦
                const progress = ((i + 1) / totalCount) * 100;
                progressFill.style.width = progress + '%';
                
                resultDiv.innerHTML = `ğŸ”„ æ­£åœ¨åŸ·è¡Œå…¨é¢æª¢æŸ¥...\n\né€²åº¦ï¼š${i + 1}/${totalCount}\næˆåŠŸï¼š${successCount}\nå¤±æ•—ï¼š${totalCount - successCount}`;
            }

            // å®Œæˆæª¢æŸ¥
            resultDiv.className = 'result success';
            resultDiv.innerHTML = `âœ… å…¨é¢æª¢æŸ¥å®Œæˆï¼\n\nç¸½è¨ˆï¼š${totalCount} é …æª¢æŸ¥\næˆåŠŸï¼š${successCount} é …\nå¤±æ•—ï¼š${totalCount - successCount} é …\n\n${successCount === totalCount ? 'ğŸ‰ æ‰€æœ‰åŠŸèƒ½æ­£å¸¸ï¼' : 'âš ï¸ è«‹æª¢æŸ¥å¤±æ•—é …ç›®'}`;

            // æ›´æ–°è³‡æ–™åº«ç‹€æ…‹
            updateDatabaseStatus();
        }

        // æª¢æŸ¥é…ç½®
        async function checkConfig() {
            if (!window.SUPABASE_CONFIG) {
                throw new Error('Supabaseé…ç½®æœªè¼‰å…¥');
            }
            if (!window.SUPABASE_CONFIG.PROJECT_URL || !window.SUPABASE_CONFIG.ANON_KEY) {
                throw new Error('Supabaseé…ç½®ä¸å®Œæ•´');
            }
            if (!window.apiService) {
                throw new Error('APIæœå‹™æœªåˆå§‹åŒ–');
            }
        }

        // æª¢æŸ¥é€£æ¥
        async function checkConnection() {
            const result = await window.apiService.testConnection();
            if (!result.success) {
                throw new Error(result.error || 'é€£æ¥å¤±æ•—');
            }
        }

        // æª¢æŸ¥èªè­‰
        async function checkAuth() {
            const testStudent = await window.apiService.login('Annie', '1234');
            if (!testStudent || !testStudent.name) {
                throw new Error('å­¸ç”Ÿç™»å…¥å¤±æ•—');
            }
        }

        // æª¢æŸ¥æˆç¸¾å„²å­˜
        async function checkScoreSave() {
            const scoreData = {
                studentName: 'TestStudent',
                quizType: 'test_quiz',
                score: 8,
                totalQuestions: 10,
                percentage: 0,
                date: new Date().toISOString()
            };
            
            const result = await window.apiService.saveScore(scoreData);
            if (!result || !result.id) {
                throw new Error('æˆç¸¾å„²å­˜å¤±æ•—');
            }
        }

        // æª¢æŸ¥æˆç¸¾æŸ¥è©¢
        async function checkScoreRetrieve() {
            const scores = await window.apiService.getAllScores();
            if (!Array.isArray(scores)) {
                throw new Error('æˆç¸¾æŸ¥è©¢å¤±æ•—');
            }
        }

        // æª¢æŸ¥é›œèªŒç·´ç¿’
        async function checkVocabulary() {
            // æª¢æŸ¥é›œèªŒç·´ç¿’é é¢æ˜¯å¦å­˜åœ¨
            const quizPages = [
                'vocabulary_quiz_part1.html',
                'vocabulary_quiz_part2.html',
                'vocabulary_quiz_part3.html',
                'vocabulary_quiz_full.html'
            ];
            
            for (const page of quizPages) {
                try {
                    const response = await fetch(page);
                    if (!response.ok) {
                        throw new Error(`é›œèªŒç·´ç¿’é é¢ ${page} ç„¡æ³•è¨ªå•`);
                    }
                } catch (error) {
                    throw new Error(`é›œèªŒç·´ç¿’é é¢æª¢æŸ¥å¤±æ•—: ${error.message}`);
                }
            }
        }

        // æª¢æŸ¥ç®¡ç†å“¡åŠŸèƒ½
        async function checkAdmin() {
            const adminLogin = await window.apiService.login('admin', 'admin123');
            if (!adminLogin || !adminLogin.isAdmin) {
                throw new Error('ç®¡ç†å“¡ç™»å…¥å¤±æ•—');
            }
        }

        // æª¢æŸ¥ç™¾åˆ†æ¯”è¨ˆç®—
        async function checkPercentage() {
            const testScores = [
                { score: 8, total: 10, expected: 80 },
                { score: 36, total: 36, expected: 100 },
                { score: 0, total: 10, expected: 0 },
                { score: 85, total: 36, expected: 100 } // æ‡‰è©²é™åˆ¶åœ¨100%
            ];

            for (const test of testScores) {
                const calculated = Math.min(Math.round((test.score / test.total) * 100), 100);
                if (calculated !== test.expected) {
                    throw new Error(`ç™¾åˆ†æ¯”è¨ˆç®—éŒ¯èª¤: ${test.score}/${test.total} æ‡‰ç‚º ${test.expected}%ï¼Œå¯¦éš›ç‚º ${calculated}%`);
                }
            }
        }

        // æ¸¬è©¦å­¸ç”Ÿç™»å…¥
        async function testStudentLogin() {
            const resultDiv = document.getElementById('checkResult');
            const studentName = document.getElementById('testStudentName').value;
            const password = document.getElementById('testStudentPassword').value;
            
            resultDiv.style.display = 'block';
            resultDiv.className = 'result info';
            resultDiv.innerHTML = `ğŸ”„ æ­£åœ¨æ¸¬è©¦å­¸ç”Ÿç™»å…¥...\n\nå­¸ç”Ÿï¼š${studentName}`;

            try {
                const student = await window.apiService.login(studentName, password);
                
                if (student) {
                    resultDiv.className = 'result success';
                    resultDiv.innerHTML = `âœ… å­¸ç”Ÿç™»å…¥æˆåŠŸï¼\n\nå§“åï¼š${student.name}\nçµ„åˆ¥ï¼š${student.group}\nç®¡ç†å“¡ï¼š${student.isAdmin ? 'æ˜¯' : 'å¦'}`;
                } else {
                    throw new Error('ç™»å…¥å¤±æ•—');
                }
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = `âŒ å­¸ç”Ÿç™»å…¥å¤±æ•—ï¼š${error.message}`;
            }
        }

        // æ¸¬è©¦æˆç¸¾å„²å­˜
        async function testScoreSave() {
            const resultDiv = document.getElementById('checkResult');
            const studentName = document.getElementById('testStudentName').value;
            
            resultDiv.style.display = 'block';
            resultDiv.className = 'result info';
            resultDiv.innerHTML = `ğŸ”„ æ­£åœ¨æ¸¬è©¦æˆç¸¾å„²å­˜...\n\nå­¸ç”Ÿï¼š${studentName}`;

            try {
                const scoreData = {
                    studentName: studentName,
                    quizType: 'comprehensive_test',
                    score: 15,
                    totalQuestions: 20,
                    percentage: 0,
                    date: new Date().toISOString()
                };

                const result = await window.apiService.saveScore(scoreData);
                
                resultDiv.className = 'result success';
                resultDiv.innerHTML = `âœ… æˆç¸¾å„²å­˜æˆåŠŸï¼\n\nå­¸ç”Ÿï¼š${studentName}\nåˆ†æ•¸ï¼š15/20 (75%)\nè¨˜éŒ„IDï¼š${result.id}`;
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = `âŒ æˆç¸¾å„²å­˜å¤±æ•—ï¼š${error.message}`;
            }
        }

        // æ¸¬è©¦é›œèªŒç·´ç¿’
        async function testVocabularyQuiz() {
            const resultDiv = document.getElementById('checkResult');
            
            resultDiv.style.display = 'block';
            resultDiv.className = 'result info';
            resultDiv.innerHTML = 'ğŸ”„ æ­£åœ¨æ¸¬è©¦é›œèªŒç·´ç¿’åŠŸèƒ½...';

            try {
                // æ¨¡æ“¬é›œèªŒç·´ç¿’å®Œæˆ
                const scoreData = {
                    studentName: document.getElementById('testStudentName').value,
                    quizType: 'vocabulary_part1',
                    score: 25,
                    totalQuestions: 36,
                    percentage: 0,
                    date: new Date().toISOString()
                };

                const result = await window.apiService.saveScore(scoreData);
                
                resultDiv.className = 'result success';
                resultDiv.innerHTML = `âœ… é›œèªŒç·´ç¿’æ¸¬è©¦æˆåŠŸï¼\n\nåˆ†æ•¸ï¼š25/36 (69%)\nè¨˜éŒ„IDï¼š${result.id}\n\né›œèªŒç·´ç¿’é é¢ï¼š\nâ€¢ vocabulary_quiz_part1.html\nâ€¢ vocabulary_quiz_part2.html\nâ€¢ vocabulary_quiz_part3.html\nâ€¢ vocabulary_quiz_full.html`;
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = `âŒ é›œèªŒç·´ç¿’æ¸¬è©¦å¤±æ•—ï¼š${error.message}`;
            }
        }

        // æ¸¬è©¦ç®¡ç†å“¡é¢æ¿
        async function testAdminPanel() {
            const resultDiv = document.getElementById('checkResult');
            
            resultDiv.style.display = 'block';
            resultDiv.className = 'result info';
            resultDiv.innerHTML = 'ğŸ”„ æ­£åœ¨æ¸¬è©¦ç®¡ç†å“¡é¢æ¿...';

            try {
                // æ¸¬è©¦ç®¡ç†å“¡ç™»å…¥
                const admin = await window.apiService.login('admin', 'admin123');
                if (!admin || !admin.isAdmin) {
                    throw new Error('ç®¡ç†å“¡ç™»å…¥å¤±æ•—');
                }

                // æ¸¬è©¦ç²å–æ‰€æœ‰æˆç¸¾
                const allScores = await window.apiService.getAllScores();
                
                resultDiv.className = 'result success';
                resultDiv.innerHTML = `âœ… ç®¡ç†å“¡é¢æ¿æ¸¬è©¦æˆåŠŸï¼\n\nç®¡ç†å“¡ï¼š${admin.name}\nç¸½æˆç¸¾è¨˜éŒ„ï¼š${allScores.length} ç­†\n\nç®¡ç†å“¡åŠŸèƒ½ï¼š\nâ€¢ æŸ¥çœ‹æ‰€æœ‰å­¸ç”Ÿæˆç¸¾\nâ€¢ æŸ¥çœ‹å­¸ç”Ÿè©³ç´°è¨˜éŒ„\nâ€¢ æˆç¸¾çµ±è¨ˆåˆ†æ`;
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = `âŒ ç®¡ç†å“¡é¢æ¿æ¸¬è©¦å¤±æ•—ï¼š${error.message}`;
            }
        }

        // æ·»åŠ æ¸¬è©¦å­¸ç”Ÿ
        async function addTestStudent() {
            const resultDiv = document.getElementById('testDataResult');
            const studentName = document.getElementById('testStudentName').value;
            const password = document.getElementById('testStudentPassword').value;
            
            resultDiv.style.display = 'block';
            resultDiv.className = 'result info';
            resultDiv.innerHTML = `ğŸ”„ æ­£åœ¨æ·»åŠ æ¸¬è©¦å­¸ç”Ÿ...\n\nå§“åï¼š${studentName}`;

            try {
                const { data, error } = await window.apiService.supabase
                    .from('students')
                    .upsert({
                        name: studentName,
                        password: password,
                        group_name: 'TestGroup',
                        isadmin: false
                    })
                    .select()
                    .single();

                if (error) {
                    throw error;
                }

                resultDiv.className = 'result success';
                resultDiv.innerHTML = `âœ… æ¸¬è©¦å­¸ç”Ÿæ·»åŠ æˆåŠŸï¼\n\nå§“åï¼š${data.name}\nçµ„åˆ¥ï¼š${data.group_name}\nIDï¼š${data.id}`;
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = `âŒ æ·»åŠ æ¸¬è©¦å­¸ç”Ÿå¤±æ•—ï¼š${error.message}`;
            }
        }

        // æŸ¥çœ‹æ‰€æœ‰å­¸ç”Ÿ
        async function viewAllStudents() {
            const resultDiv = document.getElementById('testDataResult');
            
            resultDiv.style.display = 'block';
            resultDiv.className = 'result info';
            resultDiv.innerHTML = 'ğŸ”„ æ­£åœ¨ç²å–å­¸ç”Ÿåˆ—è¡¨...';

            try {
                const students = await window.apiService.getAllStudents();
                
                if (students && students.length > 0) {
                    resultDiv.className = 'result success';
                    resultDiv.innerHTML = `âœ… æ‰¾åˆ° ${students.length} åå­¸ç”Ÿ\n\n${students.map(student => 
                        `â€¢ ${student.name} (${student.group}) ${student.isAdmin ? '[ç®¡ç†å“¡]' : ''}`
                    ).join('\n')}`;
                } else {
                    resultDiv.className = 'result info';
                    resultDiv.innerHTML = 'ğŸ“ æ²’æœ‰æ‰¾åˆ°å­¸ç”Ÿè¨˜éŒ„';
                }
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = `âŒ ç²å–å­¸ç”Ÿåˆ—è¡¨å¤±æ•—ï¼š${error.message}`;
            }
        }

        // æ›´æ–°è³‡æ–™åº«ç‹€æ…‹
        async function updateDatabaseStatus() {
            const statusDiv = document.getElementById('databaseStatus');
            
            try {
                const [students, scores] = await Promise.all([
                    window.apiService.getAllStudents(),
                    window.apiService.getAllScores()
                ]);

                const statusHTML = `
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div style="background: #d4edda; padding: 15px; border-radius: 8px;">
                            <h3>ğŸ‘¥ å­¸ç”Ÿçµ±è¨ˆ</h3>
                            <p>ç¸½å­¸ç”Ÿæ•¸ï¼š${students.length}</p>
                            <p>ç®¡ç†å“¡æ•¸ï¼š${students.filter(s => s.isAdmin).length}</p>
                        </div>
                        <div style="background: #d1ecf1; padding: 15px; border-radius: 8px;">
                            <h3>ğŸ“Š æˆç¸¾çµ±è¨ˆ</h3>
                            <p>ç¸½è¨˜éŒ„æ•¸ï¼š${scores.length}</p>
                            <p>ä»Šæ—¥è¨˜éŒ„ï¼š${scores.filter(s => new Date(s.date).toDateString() === new Date().toDateString()).length}</p>
                        </div>
                        <div style="background: #fff3cd; padding: 15px; border-radius: 8px;">
                            <h3>ğŸ”§ ç³»çµ±ç‹€æ…‹</h3>
                            <p>è³‡æ–™åº«ï¼šâœ… æ­£å¸¸</p>
                            <p>APIæœå‹™ï¼šâœ… æ­£å¸¸</p>
                        </div>
                    </div>
                `;

                statusDiv.innerHTML = statusHTML;
            } catch (error) {
                statusDiv.innerHTML = `<p style="color: red;">âŒ ç„¡æ³•ç²å–è³‡æ–™åº«ç‹€æ…‹ï¼š${error.message}</p>`;
            }
        }

        // é é¢è¼‰å…¥æ™‚åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            if (window.apiService) {
                console.log('âœ… å…¨é¢æª¢æŸ¥å·¥å…·APIæœå‹™å·²è¼‰å…¥');
                updateDatabaseStatus();
            } else {
                console.error('âŒ å…¨é¢æª¢æŸ¥å·¥å…·APIæœå‹™è¼‰å…¥å¤±æ•—');
                updateStatus('configStatus', 'error', 'âŒ APIæœå‹™è¼‰å…¥å¤±æ•—');
            }
        });
    </script>
</body>
</html>
